# VideoProcessor

[![N|face_recognition](https://github.com/ageitgey/face_recognition)](https://github.com/ageitgey/face_recognition)

VideoProcessor это оболочка вокруг  модуля  face_recognition для раннего обнаружения лиц с различных источников

VideoProcessor содержит:
  - VideoProcessorJobList класс который может вызывать методы face_recognition и запускать их в несколько процессов
  - Logeer класс, который получает результаты работы класса VideoProcessorJobList и может сохранять  их в вииде изображений обнаруженных лиц, сохранять в логфайле и при необходимаости отправлять на указанный url сервиса
  

# Возможности использования!

  - Обнаружение изображений с любого источника, пакета изображений, видео файла или видеопотока
  - Отправка изображений на указанный url


### Вызов методов класса VideoProcessorJobList и результаты их выполнения 

        
    Конструктор:
    __init__(self, logger_address, path='img')
        logger_address - адрес для отправки рабочих логов обнаруженных изображений
        path - путь для сохранения обнаруженных изображений и логов с описанием
        
    get_samples_from_video_stream(video_capture, source_id, frame_rate, debug=0)
        video_capture - объект видеопотока
        source_id - идентификатор источника(устанавливается по усмотрению)
        frame_rate - указывает как часто брать кадр т.е. берется каждый n-й кадр (где n=frame_rate)
        debug - указывает на режим отладки(если мы в режиме отладки часть отладосной информации будет выведена на консоль)
    все результаты записываются в лог
    
    get_samples_from_video_file(self, file_name, frame_rate,  debug=0)
        file_name - имя видеофайла
        source_id - идентификатор источника(устанавливается по усмотрению)
        frame_rate - указывает как часто брать кадр т.е. берется каждый n-й кадр (где n=frame_rate)
        debug - указывает на режим отладки(если мы в режиме отладки часть отладосной информации будет выведена на консоль)
    все результаты записываются в лог
        
    def batch_fotos_scan(self, batch_images_list, source_id, debug=0)
        batch_images_list - список входных изображений input images
        source_id - идентификатор источника(устанавливается по усмотрению)
        debug - указывает на режим отладки(если мы в режиме отладки часть отладосной информации будет выведена на консоль)
    все результаты записываются в лог
        
    out:
        Результатом выполнения является обьект класса FaceInfo(он сериализованный записывается в лог) а также изображения найденных лиц 
        
    Класс FaceInfo() типизирует результат поиска лиц(одного или нескольких) в отдельно взятом кадре 
  
    Он содержит:
        SourceId - идентификатор источника
        detected_face_location - координаты обнаруженных изображений top, right, bottom, left
        detected_face_encoding - вектора обнаруженных изображений
        timestamp_global - глобальное время обнаружения
        timestamp_current - Локальное время обнаружения

### Tech

VideoProcessor использует несколько модулей с открытым исходным кодом для корректной работы:

* [requests] - Модуль для работы с сетью и отправки результатов по http
* [opencv-python] - Модуль для работы с видео
* [face_recognition] - Модуль распознавания и сравнения лиц
* [joblib] - Модуль для параллельных вычислений
